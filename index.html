<!--
üåü FILE: menu.html
üìå SCOPO: Menu interattivo per pizzeria "Mixed by Genny" con AI vocale e cambio lingua
üõ†Ô∏è MODIFICHE: Aggiunto sfondo con cornice e suggerimenti nei commenti, palette calda, traduzioni inglesi per descrizioni pizze e selettore lingua solo per AI
-->

<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Menu - Mixed by Genny</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #4B1414, #4B1414);
      border: 2px solid #6C1E1E;
      padding: 10px;
      box-sizing: border-box;
      color: #F5E2C8;
    }

    header {
      text-align: center;
      padding: 20px;
    }
    header img {
      width: 100%;
      max-width: 480px;
    }

    main {
      padding: 20px;
      max-width: 800px;
      margin: auto;
    }

    .pizza {
      background: #D4A373;
      border-radius: 12px;
      padding: 15px;
      margin: 20px 0;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
      display: flex;
      align-items: center;
      gap: 20px;
      color: #4B1414;
    }

    .pizza img {
      width: 110px;
      height: 110px;
      border-radius: 10px;
      object-fit: cover;
      background: #6C1E1E;
      border: 3px solid #4B1414;
    }

    .pizza-info {
      flex: 1;
    }

    .pizza-name {
      font-size: 1.5em;
      margin: 0;
    }

    .pizza-ingredients {
      font-size: 0.9em;
    }

    .pizza-price {
      font-size: 1em;
      font-weight: bold;
    }

    footer {
      text-align: center;
      font-size: 0.9em;
      padding: 15px;
      background: #6C1E1E;
      color: #F5E2C8;
      margin-top: 40px;
    }

    #ai-fab {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 60px;
      height: 60px;
      background: #D4A373;
      color: #4B1414;
      font-size: 20px;
      border-radius: 50%;
      text-align: center;
      line-height: 60px;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      z-index: 1000;
      font-weight: bold;
    }

    #ai-popup {
      position: fixed;
      bottom: 90px;
      right: 20px;
      background: #F5E2C8;
      padding: 20px;
      border-radius: 20px;
      width: 280px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.3);
      display: none;
      z-index: 999;
      color: #4B1414;
    }

    #ai-popup .popup-content {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    #ai-popup input,
    #ai-popup button {
      padding: 10px;
      font-size: 1em;
      border-radius: 8px;
      border: 1px solid #6C1E1E;
    }

    #ai-popup button {
      background-color: #D4A373;
      color: #4B1414;
      border: none;
      cursor: pointer;
    }

    #risposta-ai {
      font-size: 1em;
      font-weight: bold;
      white-space: pre-line;
    }

    .lang-switch {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-bottom: 10px;
    }

    .lang-switch button {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border: none;
      cursor: pointer;
      font-size: 18px;
    }
  </style>
</head>
<body>
  <header>
    <img src="logo.png" alt="Logo Mixed by Genny" />
  </header>

  <main>
    <div class="pizza margherita">
      <img src="diavola1.jpeg" alt="Margherita" />
      <div class="pizza-info">
        <p class="pizza-name">Margherita</p>
        <p class="pizza-ingredients">Pomodoro, mozzarella, basilico<br><em>Tomato, mozzarella, basil</em></p>
        <p class="pizza-price">10‚Ç¨</p>
      </div>
    </div>

    <div class="pizza diavola1">
      <img src="diavola1.jpeg" alt="Diavola" />
      <div class="pizza-info">
        <p class="pizza-name">Diavola</p>
        <p class="pizza-ingredients">Mozzarella, pomodoro, salame piccante<br><em>Mozzarella, tomato, spicy salami</em></p>
        <p class="pizza-price">10‚Ç¨</p>
      </div>
    </div>

    <div class="pizza gorgonzola">
      <img src="diavola1.jpeg" alt="Gorgonzola" />
      <div class="pizza-info">
        <p class="pizza-name">Gorgonzola</p>
        <p class="pizza-ingredients">Mozzarella, gorgonzola, noci<br><em>Mozzarella, gorgonzola, walnuts</em></p>
        <p class="pizza-price">10‚Ç¨</p>
      </div>
    </div>

    <div class="pizza mixed">
      <img src="diavola1.jpeg" alt="Mixed by Genny" />
      <div class="pizza-info">
        <p class="pizza-name">Mixed by Genny</p>
        <p class="pizza-ingredients">Interagisci con l'AI e Genny far√† una pizza speciale solo per te<br><em>Interact with the AI and Genny will maka a special pizza for you</em></p>
        <p class="pizza-price">10‚Ç¨</p>
      </div>
    </div>
  </main>

  <div id="ai-fab" onclick="togglePopup()">AI</div>

  <div id="ai-popup">
    <div class="lang-switch">
      <button onclick="setLang('it')">üáÆüáπ</button>
      <button onclick="setLang('en')">üá¨üáß</button>
    </div>
    <div class="popup-content">
      <h2 id="title-prompt">Dimmi cosa ti piace!</h2>
      <input type="text" id="gusto" placeholder="Es: mozzarella, pomodoro" />
      <button onclick="consiglia()">Scrivimi i tuop gusti üçï</button>
      <button onclick="parla()">üéôÔ∏è Parla con me</button>
      <div id="risposta-ai"></div>
    </div>
  </div>

  <footer>
    Coperto: 2‚Ç¨ a persona (include acqua da 50ml)
  </footer>

  <script>
    let currentLang = 'it';

    function setLang(lang) {
      currentLang = lang;
      document.documentElement.lang = lang;
      document.getElementById("title-prompt").textContent = lang === 'it' ? "Dimmi cosa ti piace!" : "Tell me what you like!";
      document.getElementById("gusto").placeholder = lang === 'it' ? "Es: mozzarella, pomodoro" : "E.g.: mozzarella, tomato";
    }

    function togglePopup() {
      const popup = document.getElementById("ai-popup");
      popup.style.display = popup.style.display === "block" ? "none" : "block";
    }

    async function consiglia() {
      const gustoInput = document.getElementById('gusto').value.trim();
      const rispostaDiv = document.getElementById('risposta-ai');
      if (!gustoInput) {
        rispostaDiv.textContent = currentLang === 'it' ? "Inserisci qualche ingrediente!" : "Please enter some ingredients!";
        return;
      }
      
      const data = await chiediConsiglio(gustoInput);
      rispostaDiv.innerHTML = `<strong>${data.risposta}</strong>`;
      const utter = new SpeechSynthesisUtterance(data.risposta);
      utter.lang = currentLang === 'it' ? 'it-IT' : 'en-US';
      window.speechSynthesis.speak(utter);
    }

    function parla() {
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      if (!SpeechRecognition) {
        alert(currentLang === 'it' ? "Il tuo browser non supporta il riconoscimento vocale." : "Your browser does not support voice recognition.");
        return;
      }
      const recognition = new SpeechRecognition();
      recognition.lang = currentLang === 'it' ? 'it-IT' : 'en-US';
      recognition.start();

      const rispostaDiv = document.getElementById('risposta-ai');
      rispostaDiv.textContent = currentLang === 'it' ? "Sto ascoltando... üéß" : "Listening... üéß";

      recognition.onresult = async (event) => {
        const input = event.results[0][0].transcript;
        document.getElementById('gusto').value = input;
        rispostaDiv.textContent = currentLang === 'it' ? "Elaboro... ü§ñ" : "Processing... ü§ñ";
        const data = await chiediConsiglio(input);
        rispostaDiv.innerHTML = `<strong>${data.risposta}</strong>`;
        const utter = new SpeechSynthesisUtterance(data.risposta);
        utter.lang = currentLang === 'it' ? 'it-IT' : 'en-US';
        window.speechSynthesis.speak(utter);
      };

      recognition.onerror = (event) => {
        rispostaDiv.textContent = currentLang === 'it' ? "Errore nel riconoscimento vocale." : "Speech recognition error.";
      };
    }

<input id="input-utente" placeholder="Come ti senti o cosa ti piace?">
<button onclick="consiglia()">Chiedi consiglio</button>
<p id="risposta-ai"></p>

<script>
  async function consiglia() {
    const testo = document.getElementById("input-utente").value;
    const { risposta } = await chiediConsiglio(testo);
    document.getElementById("risposta-ai").textContent = risposta;
  }
</script>
<script>
const ingredientiAI = [
  "mozzarella", "pomodoro", "salame", "funghi", "carciofi", "olive", "tonno", "cipolla", "peperoni",
  "gorgonzola", "basilico", "zucchine", "melanzane", "salsiccia", "bufala", "scamorza", "provola",
  "pancetta", "prosciutto", "acciughe", "uovo", "panna", "tartufo", "rucola", "pomodorini", "origano",
  "grana", "fontina", "speck", "wurstel", "radicchio", "crema di tartufo", "formaggio di capra", "porcini",
  "bresaola", "limone", "lattuga", "mais", "avocado", "zucca", "miele", "nocciole", "pesto", "cetrioli",
  "peperoncino", "carne macinata", "pollo", "hamburger", "uova strapazzate", "emmental", "camembert",
  "blue cheese", "ricotta", "spinaci", "patate", "patatine", "rosmarino", "asparagi", "prosciutto crudo",
  "capperi", "mandorle", "cioccolato", "nutella", "fragole", "banana", "ciliegie", "pistacchi", "lime",
  "cocco", "ananas", "jalapeno", "senape", "ketchup", "salsa barbecue", "tabasco", "formaggio fuso",
  "crema di funghi", "crema di peperoni", "crema di zucca", "pomodori secchi", "carne affumicata",
  "salmone", "gamberi", "cozze", "polpo", "tonno affumicato", "calamari", "crema di gamberi", "zenzero",
  "aglio", "cipollotto", "barbabietola", "ravanelli", "cavolo", "funghi shitake", "alghe", "wasabi"
];

const emozioniAI = {
  triste: ["triste", "gi√π", "deluso", "depresso", "cupo"],
  felice: ["felice", "contento", "allegro", "raggiante", "gioioso"],
  arrabbiato: ["arrabbiato", "furioso", "agitato", "irritato", "nervoso"],
  stressato: ["stressato", "teso", "ansioso", "esausto", "carico"],
  curioso: ["curioso", "sognante", "strano", "fantasioso", "sperimentale"],
  romantico: ["romantico", "innamorato", "dolce", "tenero", "sentimentale"],
  energico: ["energico", "attivo", "vivace", "dinamico", "euforico"],
  rilassato: ["rilassato", "tranquillo", "sereno", "calmo", "zen"]
};

function trovaEmozione(testo) {
  const input = testo.toLowerCase();
  for (const [emozione, sinonimi] of Object.entries(emozioniAI)) {
    if (sinonimi.some(parola => input.includes(parola))) {
      return emozione;
    }
  }
  return null;
}

function trovaIngredienti(testo) {
  const input = testo.toLowerCase();
  return ingredientiAI.filter(ingrediente => input.includes(ingrediente));
}

async function chiediConsiglio(inputUtente) {
  return new Promise((resolve) => {
    const umore = trovaEmozione(inputUtente);
    const ingredienti = trovaIngredienti(inputUtente);
    let risposta = "";

    if (ingredienti.includes("nutella") || (umore === "stressato" && inputUtente.toLowerCase().includes("dolce"))) {
      risposta = "Hai avuto una giornata pesante. Ti consiglio una pizza alla Nutella per chiuderla con dolcezza.";
    } else if (ingredienti.length > 0) {
      risposta = `Con gli ingredienti che hai scelto (${ingredienti.join(", ")}), potremmo creare una pizza su misura per te.`;
    } else if (umore) {
      const suggerimenti = {
        triste: "Prova una Boscaiola: cremosa e intensa, per tirarti su.",
        felice: "Festeggia con una Capricciosa, ricca e piena di sapore.",
        arrabbiato: "Sfogati con una Diavola molto piccante.",
        stressato: "Rilassati con una Margherita semplice e perfetta.",
        curioso: "Prova una Tartufata, elegante e fuori dal comune.",
        romantico: "Una Bufalina delicata √® perfetta per un momento speciale.",
        energico: "Lanciati con una Quattro Formaggi ricca e decisa.",
        rilassato: "Una Vegetariana leggera si abbina al tuo stato d‚Äôanimo."
      };
      risposta = suggerimenti[umore];
    } else {
      risposta = "Dimmi come ti senti o cosa ti piace, e ti consiglier√≤ la pizza perfetta.";
    }

    // ‚úÖ Sintesi vocale (una sola volta, senza bug)
    if ('speechSynthesis' in window) {
      window.speechSynthesis.cancel(); // ferma qualsiasi parlato in corso
      const utter = new SpeechSynthesisUtterance(risposta);
      utter.lang = "it-IT";
      setTimeout(() => window.speechSynthesis.speak(utter), 100);
    }

    resolve({ risposta });
  });
}
</script>






  </script>
</body>
</html>
